"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("tslib"),t=require("react/jsx-runtime"),n=require("react"),o=require("tim-js-sdk"),r=require("../../context/TUIKitContext.js");require("../../context/TUIChatStateContext.js"),require("../../context/TUIChatActionContext.js"),require("../../context/TUIMessageContext.js"),require("../../context/ComponentContext.js"),require("../../context/TUIMessageInputContext.js");var i=require("./hooks/useConversationList.js"),s=require("../ConversationPreview/ConversationPreview.js");require("../ConversationPreview/ConversationPreviewContent.js");var a=require("../ConversationPreview/ConversationListContainer.js"),v=require("../Profile/Profile.js"),u=require("../ConversationSearch/ConversationSearchInput.js"),c=require("../ConversationSearch/ConversationSearchResult.js"),C=require("../ConversationCreate/ConversationCreate.js"),l=require("../Icon/Icon.js"),d=require("../Icon/type.js");require("../Input/Input.js"),require("../ConversationCreate/ConversationGroupTypeInfo.js");var j=require("../../context/TUIConversationContext.js"),f=require("../ConversationPreview/utils.js"),x=require("./hooks/useConversationUpdate.js");function h(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var p=h(n),I=h(o);function q(o){var h=o.Preview,p=o.Container,q=void 0===p?a.ConversationListContainer:p,P=o.onConversationListUpdated,g=o.filterConversation,T=o.showSelf,U=void 0===T||T,_=o.showSearch,w=void 0===_||_,m=o.onlyGroupConversation,L=void 0!==m&&m,S=o.onlyC2CConversation,y=void 0!==S&&S,N=r.useTUIKitContext("TUIConversationList"),A=N.tim,R=N.customClasses,E=N.conversation,O=N.setActiveConversation,b=N.setTUIProfileShow,k=j.useTUIConversationContext("TUIConversationList").filterConversation,D=g||k,M=n.useState(0),F=M[0],G=M[1],K=i(A,(function(e,t){e.length&&O(E)}),D),V=K.conversationList,Y=K.setConversationList;x.useConversationUpdate(Y,P,(function(){return G((function(e){return e+1}))}),D);var z=n.useState(""),B=z[0],H=z[1],J=n.useState(V),Q=J[0],W=J[1],X=n.useState(!1),Z=X[0],$=X[1],ee=r.useTUIKitContext().myProfile,te=n.useRef(null);return t.jsx("div",e.__assign({className:"tui-conversation ".concat(R||""),ref:te},{children:Z?t.jsx(C.ConversationCreate,{conversationList:V,setConversationCreated:$}):t.jsxs(t.Fragment,{children:[U&&t.jsx(v.Profile,{profile:ee,handleAvatar:function(){b(!0)}}),w&&t.jsxs("div",e.__assign({className:"tui-conversation-header"},{children:[t.jsx(u.ConversationSearchInput,{value:B,clearable:!0,onChange:function(e){var t,n;if(H(null===(t=e.target)||void 0===t?void 0:t.value),null===(n=e.target)||void 0===n?void 0:n.value){var o=V.filter((function(t){var n;return f.getDisplayTitle(t).toLocaleLowerCase().includes(null===(n=e.target)||void 0===n?void 0:n.value.toLocaleLowerCase())}));W(o)}else W([])}}),t.jsx("div",e.__assign({className:"tui-conversation-create-icon"},{children:t.jsx(l.Icon,{onClick:function(){H(""),$(!0)},type:d.IconTypes.CREATE,height:24,width:24})}))]})),t.jsx(q,e.__assign({setConversationList:Y},{children:0===V.length?t.jsxs("div",e.__assign({className:"no-result"},{children:[t.jsx(l.Icon,{className:"no-result-icon",type:d.IconTypes.EFFORT,width:42,height:42}),t.jsx("div",e.__assign({className:"no-result-message"},{children:"No conversation"}))]})):B?t.jsx(c.ConversationSearchResult,{Preview:h,searchValue:B,result:Q}):L?V.filter((function(e){return e.type===I.default.TYPES.CONV_GROUP})).map((function(n){var o={activeConversation:E,conversation:n,setActiveConversation:O,Preview:h,conversationUpdateCount:F};return t.jsx(s.ConversationPreview,e.__assign({},o),n.conversationID)})):y?V.filter((function(e){return e.type===I.default.TYPES.CONV_C2C})).map((function(n){var o={activeConversation:E,conversation:n,setActiveConversation:O,Preview:h,conversationUpdateCount:F};return t.jsx(s.ConversationPreview,e.__assign({},o),n.conversationID)})):V.map((function(n){var o={activeConversation:E,conversation:n,setActiveConversation:O,Preview:h,conversationUpdateCount:F};return t.jsx(s.ConversationPreview,e.__assign({},o),n.conversationID)}))}))]})}))}var P=p.default.memo(q);exports.TUIConversationList=P,exports.UnMemoTUIConversationList=q;
