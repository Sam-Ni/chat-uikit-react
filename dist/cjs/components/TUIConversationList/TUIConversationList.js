"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("tslib"),t=require("react/jsx-runtime"),n=require("react"),r=require("../../context/TUIKitContext.js");require("../../context/TUIChatStateContext.js"),require("../../context/TUIChatActionContext.js"),require("../../context/TUIMessageContext.js"),require("../../context/ComponentContext.js"),require("../../context/TUIMessageInputContext.js");var o=require("./hooks/useConversationList.js"),s=require("../ConversationPreview/ConversationPreview.js");require("../ConversationPreview/ConversationPreviewContent.js");var i=require("../ConversationPreview/ConversationListContainer.js"),a=require("../Profile/Profile.js"),v=require("../ConversationSearch/ConversationSearchInput.js"),u=require("../ConversationSearch/ConversationSearchResult.js"),c=require("../ConversationCreate/ConversationCreate.js"),C=require("../Icon/Icon.js"),l=require("../Icon/type.js");require("../Input/Input.js"),require("../ConversationCreate/ConversationGroupTypeInfo.js"),require("tim-js-sdk");var j=require("../../context/TUIConversationContext.js"),d=require("../ConversationPreview/utils.js"),x=require("./hooks/useConversationUpdate.js");function h(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function f(h){var f=h.Preview,I=h.Container,p=void 0===I?i.ConversationListContainer:I,q=h.onConversationListUpdated,g=h.filterConversation,T=r.useTUIKitContext("TUIConversationList"),U=T.tim,m=T.customClasses,L=T.conversation,P=T.setActiveConversation,_=T.setTUIProfileShow,w=j.useTUIConversationContext("TUIConversationList").filterConversation,S=g||w,y=n.useState(0),N=y[0],A=y[1],R=o(U,(function(e,t){e.length&&P(L)}),S),b=R.conversationList,k=R.setConversationList;x.useConversationUpdate(k,q,(function(){return A((function(e){return e+1}))}),S);var M=n.useState(""),E=M[0],F=M[1],K=n.useState(b),D=K[0],O=K[1],G=n.useState(!1),V=G[0],z=G[1],B=r.useTUIKitContext().myProfile,H=n.useRef(null);return t.jsx("div",e.__assign({className:"tui-conversation ".concat(m||""),ref:H},{children:V?t.jsx(c.ConversationCreate,{conversationList:b,setConversationCreated:z}):t.jsxs(t.Fragment,{children:[t.jsx(a.Profile,{profile:B,handleAvatar:function(){_(!0)}}),t.jsxs("div",e.__assign({className:"tui-conversation-header"},{children:[t.jsx(v.ConversationSearchInput,{value:E,clearable:!0,onChange:function(e){var t,n;if(F(null===(t=e.target)||void 0===t?void 0:t.value),null===(n=e.target)||void 0===n?void 0:n.value){var r=b.filter((function(t){var n;return d.getDisplayTitle(t).toLocaleLowerCase().includes(null===(n=e.target)||void 0===n?void 0:n.value.toLocaleLowerCase())}));O(r)}else O([])}}),t.jsx("div",e.__assign({className:"tui-conversation-create-icon"},{children:t.jsx(C.Icon,{onClick:function(){F(""),z(!0)},type:l.IconTypes.CREATE,height:24,width:24})}))]})),t.jsx(p,e.__assign({setConversationList:k},{children:0===b.length?t.jsxs("div",e.__assign({className:"no-result"},{children:[t.jsx(C.Icon,{className:"no-result-icon",type:l.IconTypes.EFFORT,width:42,height:42}),t.jsx("div",e.__assign({className:"no-result-message"},{children:"No conversation"}))]})):E?t.jsx(u.ConversationSearchResult,{Preview:f,searchValue:E,result:D}):b.map((function(n){var r={activeConversation:L,conversation:n,setActiveConversation:P,Preview:f,conversationUpdateCount:N};return t.jsx(s.ConversationPreview,e.__assign({},r),n.conversationID)}))}))]})}))}var I=h(n).default.memo(f);exports.TUIConversationList=I,exports.UnMemoTUIConversationList=f;
