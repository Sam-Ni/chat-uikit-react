"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("tslib"),t=require("react/jsx-runtime"),n=require("react"),r=require("../../context/TUIKitContext.js");require("../../context/TUIMessageContext.js");var o=require("./hooks/useConversationList.js"),s=require("../ConversationPreview/ConversationPreview.js"),i=require("../Icon/Icon.js"),a=require("../Icon/type.js");require("tim-js-sdk");var v=require("../../context/TUIConversationContext.js"),u=require("../ConversationPreview/ConversationListContainer.js"),c=require("../Profile/Profile.js"),l=require("../ConversationSearch/ConversationSearchInput.js"),C=require("../ConversationSearch/ConversationSearchResult.js"),d=require("../ConversationCreate/ConversationCreate.js");require("../ConversationCreate/ConversationGroupTypeInfo.js");var j=require("../ConversationPreview/utils.js"),f=require("./hooks/useConversationUpdate.js");function h(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function x(h){var x=h.Preview,I=h.Container,p=void 0===I?u.ConversationListContainer:I,g=h.onConversationListUpdated,q=h.filterConversation,m=r.useTUIKitContext("TUIConversationList"),T=m.tim,L=m.customClasses,U=m.conversation,_=m.setActiveConversation,P=m.setTUIProfileShow,w=v.useTUIConversationContext("TUIConversationList").filterConversation,S=q||w,y=n.useState(0),N=y[0],R=y[1],b=o(T,(function(e,t){e.length&&_(U)}),S),k=b.conversationList,A=b.setConversationList;f.useConversationUpdate(A,g,(function(){return R((function(e){return e+1}))}),S);var E=n.useState(""),F=E[0],K=E[1],M=n.useState(k),D=M[0],O=M[1],G=n.useState(!1),V=G[0],z=G[1],B=r.useTUIKitContext().myProfile,H=n.useRef(null);return t.jsx("div",e.__assign({className:"tui-conversation ".concat(L||""),ref:H},{children:V?t.jsx(d.ConversationCreate,{conversationList:k,setConversationCreated:z}):t.jsxs(t.Fragment,{children:[t.jsx(c.Profile,{profile:B,handleAvatar:function(){P(!0)}}),t.jsxs("div",e.__assign({className:"tui-conversation-header"},{children:[t.jsx(l.ConversationSearchInput,{value:F,clearable:!0,onChange:function(e){var t,n;if(K(null===(t=e.target)||void 0===t?void 0:t.value),null===(n=e.target)||void 0===n?void 0:n.value){var r=k.filter((function(t){var n;return j.getDisplayTitle(t).toLocaleLowerCase().includes(null===(n=e.target)||void 0===n?void 0:n.value.toLocaleLowerCase())}));O(r)}else O([])}}),t.jsx("div",e.__assign({className:"tui-conversation-create-icon"},{children:t.jsx(i.Icon,{onClick:function(){K(""),z(!0)},type:a.IconTypes.CREATE,height:24,width:24})}))]})),t.jsx(p,e.__assign({setConversationList:A},{children:0===k.length?t.jsxs("div",e.__assign({className:"no-result"},{children:[t.jsx(i.Icon,{className:"no-result-icon",type:a.IconTypes.EFFORT,width:42,height:42}),t.jsx("div",e.__assign({className:"no-result-message"},{children:"No conversation"}))]})):F?t.jsx(C.ConversationSearchResult,{Preview:x,searchValue:F,result:D}):k.map((function(n){var r={activeConversation:U,conversation:n,setActiveConversation:_,Preview:x,conversationUpdateCount:N};return t.jsx(s.ConversationPreview,e.__assign({},r),n.conversationID)}))}))]})}))}var I=h(n).default.memo(x);exports.TUIConversationList=I,exports.UnMemoTUIConversationList=x;
