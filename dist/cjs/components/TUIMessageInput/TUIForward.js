"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("tslib"),s=require("react/jsx-runtime"),a=require("react");require("../../context/TUIKitContext.js"),require("../../context/TUIChatStateContext.js");var i=require("../../context/TUIChatActionContext.js");require("../../context/TUIMessageContext.js"),require("../../context/ComponentContext.js"),require("../../context/TUIMessageInputContext.js");var t=require("../Model/index.js"),n=require("../Icon/Icon.js"),r=require("../Icon/type.js"),o=require("../Input/Input.js"),l=require("../Checkbox/index.js"),c=require("../Avatar/Avatar.js"),u=require("../ConversationPreview/utils.js"),d=require("../../constants.js");require("./hooks/useHandleQuoteMessage.js");var h=require("./hooks/useHandleForwardMessage.js");exports.TUIForward=function(g){var x=g.handleForward,_=a.useState([]),j=_[0],v=_[1],m=a.useState([]),f=m[0],p=m[1],C=a.useState(""),I=C[0],w=C[1],N=i.useTUIChatActionContext().operateMessage,q=h.useHandleForwardMessage(),T=q.message,y=q.sendForwardMessage,D=q.conversationList,b=void 0===D?[]:D;console.log("TUIForward",T);var k,A=a.useCallback((function(e){var s;N(((s={})[d.MESSAGE_OPERATE.FORWARD]=null,s))}),[N]),F=b.slice(0,2),M=b.slice(2),S=function(s){s.checked?v(e.__spreadArray(e.__spreadArray([],j,!0),[s.value],!1)):v(j.filter((function(e){return e!==s.value})))};return a.useEffect((function(){v([]),p([]),w("")}),[T]),T&&b.length>0&&s.jsxs(t.Model,e.__assign({onClick:A},{children:[s.jsxs("div",e.__assign({role:"button",tabIndex:0,className:"tui-forward",onClick:function(e){e.stopPropagation()}},{children:[s.jsxs("header",e.__assign({className:"tui-forward-header"},{children:[s.jsx(n.Icon,{type:r.IconTypes.CANCEL,width:16,height:16,onClick:A}),s.jsx("h2",e.__assign({className:"tui-forward-title"},{children:"Forward To"}))]})),s.jsx("div",e.__assign({className:"tui-forward-search"},{children:s.jsx(o.Input,{className:"tui-forward-search-input",placeholder:"Search",clearable:!0,value:I,onChange:function(e){var s,a;if(w(null===(s=e.target)||void 0===s?void 0:s.value),null===(a=e.target)||void 0===a?void 0:a.value){var i=b.filter((function(s){var a,i=u.getDisplayTitle(s).toLocaleLowerCase(),t=null===(a=e.target)||void 0===a?void 0:a.value.toLocaleLowerCase();return i.includes(t)}));p(i)}else p([])},prefix:s.jsx(n.Icon,{type:r.IconTypes.SEARCH,height:16,width:16})})})),s.jsxs("main",e.__assign({className:"tui-forward-main"},{children:[I&&s.jsxs("ul",e.__assign({className:"tui-forward-list"},{children:[s.jsx("h3",e.__assign({className:"tui-forward-list-title"},{children:"Search Result"})),f.length>0&&f.map((function(a){return s.jsxs("li",e.__assign({className:"tui-forward-list-item"},{children:[s.jsxs("label",e.__assign({htmlFor:"".concat(a.conversationID),className:"info"},{children:[s.jsx(c.Avatar,{image:u.getDisplayImage(a),size:40}),s.jsx("div",e.__assign({className:"info-nick"},{children:u.getDisplayTitle(a)}))]})),s.jsx(l.Checkbox,{onChange:S,id:"".concat(a.conversationID),value:a})]}),a.conversationID)})),0===f.length&&s.jsx("p",e.__assign({className:"no-result"},{children:"No Result"}))]})),!I&&F.length>0&&s.jsxs("ul",e.__assign({className:"tui-forward-list"},{children:[s.jsx("h3",e.__assign({className:"tui-forward-list-title"},{children:"Frequently Contacted Test"})),F.map((function(a){return s.jsxs("li",e.__assign({className:"tui-forward-list-item"},{children:[s.jsxs("label",e.__assign({htmlFor:"".concat(a.conversationID),className:"info"},{children:[s.jsx(c.Avatar,{image:u.getDisplayImage(a),size:40}),s.jsx("div",e.__assign({className:"info-nick"},{children:u.getDisplayTitle(a)}))]})),s.jsx(l.Checkbox,{onChange:S,id:"".concat(a.conversationID),value:a})]}),a.conversationID)}))]})),!I&&M.length>0&&s.jsxs("ul",e.__assign({className:"tui-forward-list"},{children:[s.jsx("h3",e.__assign({className:"tui-forward-list-title"},{children:"Recent Chats"})),M.map((function(a){return s.jsxs("li",e.__assign({className:"tui-forward-list-item"},{children:[s.jsxs("label",e.__assign({htmlFor:"".concat(a.conversationID),className:"info"},{children:[s.jsx(c.Avatar,{image:u.getDisplayImage(a),size:40}),s.jsx("div",e.__assign({className:"info-nick"},{children:u.getDisplayTitle(a)}))]})),s.jsx(l.Checkbox,{onChange:S,id:"".concat(a.conversationID),value:a})]}),a.conversationID)}))]}))]})),s.jsxs("footer",e.__assign({className:"tui-forward-footer"},{children:[s.jsx("div",e.__assign({className:"tui-forward-footer-name"},{children:j.length>0&&(k=j,(null==k?void 0:k.map((function(e){return u.getDisplayTitle(e)}))).toString())})),s.jsx("button",e.__assign({type:"button",className:"button",onClick:function(){var e;e=j,x?x({list:j,message:T}):y(j),A(e)},disabled:0===j.length},{children:"Forward"}))]}))]})),s.jsx("div",{children:"Test"})]}))};
