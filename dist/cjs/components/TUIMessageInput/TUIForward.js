"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("tslib"),s=require("react/jsx-runtime"),a=require("react");require("../../context/TUIKitContext.js"),require("../../context/TUIChatStateContext.js");var i=require("../../context/TUIChatActionContext.js");require("../../context/TUIMessageContext.js"),require("../../context/ComponentContext.js"),require("../../context/TUIMessageInputContext.js");var t=require("../Model/index.js"),n=require("../Icon/Icon.js"),r=require("../Icon/type.js"),o=require("../Input/Input.js"),l=require("../Checkbox/index.js"),c=require("../Avatar/Avatar.js"),u=require("../ConversationPreview/utils.js"),d=require("../../constants.js");require("./hooks/useHandleQuoteMessage.js");var h=require("./hooks/useHandleForwardMessage.js");exports.TUIForward=function(g){var x,_=g.handleForward,j=a.useState([]),v=j[0],m=j[1],f=a.useState([]),p=f[0],C=f[1],I=a.useState(""),w=I[0],N=I[1],q=i.useTUIChatActionContext().operateMessage,y=h.useHandleForwardMessage(),D=y.message,b=y.sendForwardMessage,T=y.conversationList,k=void 0===T?[]:T,A=a.useCallback((function(e){var s;q(((s={})[d.MESSAGE_OPERATE.FORWARD]=null,s))}),[q]),F=k.slice(0,2),M=k.slice(2),S=function(s){s.checked?m(e.__spreadArray(e.__spreadArray([],v,!0),[s.value],!1)):m(v.filter((function(e){return e!==s.value})))};return a.useEffect((function(){m([]),C([]),N("")}),[D]),D&&k.length>0&&s.jsx(t.Model,e.__assign({onClick:A},{children:s.jsxs("div",e.__assign({role:"button",tabIndex:0,className:"tui-forward",onClick:function(e){e.stopPropagation()}},{children:[s.jsxs("header",e.__assign({className:"tui-forward-header"},{children:[s.jsx(n.Icon,{type:r.IconTypes.CANCEL,width:16,height:16,onClick:A}),s.jsx("h2",e.__assign({className:"tui-forward-title"},{children:"Forward To"}))]})),s.jsx("div",e.__assign({className:"tui-forward-search"},{children:s.jsx(o.Input,{className:"tui-forward-search-input",placeholder:"Search",clearable:!0,value:w,onChange:function(e){var s,a;if(N(null===(s=e.target)||void 0===s?void 0:s.value),null===(a=e.target)||void 0===a?void 0:a.value){var i=k.filter((function(s){var a,i=u.getDisplayTitle(s).toLocaleLowerCase(),t=null===(a=e.target)||void 0===a?void 0:a.value.toLocaleLowerCase();return i.includes(t)}));C(i)}else C([])},prefix:s.jsx(n.Icon,{type:r.IconTypes.SEARCH,height:16,width:16})})})),s.jsxs("main",e.__assign({className:"tui-forward-main"},{children:[w&&s.jsxs("ul",e.__assign({className:"tui-forward-list"},{children:[s.jsx("h3",e.__assign({className:"tui-forward-list-title"},{children:"Search Result"})),p.length>0&&p.map((function(a){return s.jsxs("li",e.__assign({className:"tui-forward-list-item"},{children:[s.jsxs("label",e.__assign({htmlFor:"".concat(a.conversationID),className:"info"},{children:[s.jsx(c.Avatar,{image:u.getDisplayImage(a),size:40}),s.jsx("div",e.__assign({className:"info-nick"},{children:u.getDisplayTitle(a)}))]})),s.jsx(l.Checkbox,{onChange:S,id:"".concat(a.conversationID),value:a})]}),a.conversationID)})),0===p.length&&s.jsx("p",e.__assign({className:"no-result"},{children:"No Result"}))]})),!w&&F.length>0&&s.jsxs("ul",e.__assign({className:"tui-forward-list"},{children:[s.jsx("h3",e.__assign({className:"tui-forward-list-title"},{children:"Frequently Contacted"})),F.map((function(a){return s.jsxs("li",e.__assign({className:"tui-forward-list-item"},{children:[s.jsxs("label",e.__assign({htmlFor:"".concat(a.conversationID),className:"info"},{children:[s.jsx(c.Avatar,{image:u.getDisplayImage(a),size:40}),s.jsx("div",e.__assign({className:"info-nick"},{children:u.getDisplayTitle(a)}))]})),s.jsx(l.Checkbox,{onChange:S,id:"".concat(a.conversationID),value:a})]}),a.conversationID)}))]})),!w&&M.length>0&&s.jsxs("ul",e.__assign({className:"tui-forward-list"},{children:[s.jsx("h3",e.__assign({className:"tui-forward-list-title"},{children:"Recent Chats"})),M.map((function(a){return s.jsxs("li",e.__assign({className:"tui-forward-list-item"},{children:[s.jsxs("label",e.__assign({htmlFor:"".concat(a.conversationID),className:"info"},{children:[s.jsx(c.Avatar,{image:u.getDisplayImage(a),size:40}),s.jsx("div",e.__assign({className:"info-nick"},{children:u.getDisplayTitle(a)}))]})),s.jsx(l.Checkbox,{onChange:S,id:"".concat(a.conversationID),value:a})]}),a.conversationID)}))]}))]})),s.jsxs("footer",e.__assign({className:"tui-forward-footer"},{children:[s.jsx("div",e.__assign({className:"tui-forward-footer-name"},{children:v.length>0&&(x=v,(null==x?void 0:x.map((function(e){return u.getDisplayTitle(e)}))).toString())})),s.jsx("button",e.__assign({type:"button",className:"button",onClick:function(){var e;e=v,_?_({list:v,message:D}):b(v),A(e)},disabled:0===v.length},{children:"Forward"}))]}))]}))}))};
