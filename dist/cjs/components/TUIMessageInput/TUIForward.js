"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("tslib"),s=require("react/jsx-runtime"),a=require("react"),i=require("../../context/TUIChatActionContext.js");require("../../context/TUIMessageContext.js");var n=require("../Model/index.js"),t=require("../Icon/Icon.js"),r=require("../Icon/type.js"),l=require("../Input/Input.js"),o=require("../Checkbox/index.js"),c=require("../Avatar/Avatar.js"),u=require("../ConversationPreview/utils.js"),d=require("../../constants.js");require("./hooks/useHandleQuoteMessage.js");var h=require("./hooks/useHandleForwardMessage.js");exports.TUIForward=function(g){var _,v=g.handleForward,x=a.useState([]),j=x[0],m=x[1],f=a.useState([]),p=f[0],w=f[1],I=a.useState(""),N=I[0],C=I[1],y=i.useTUIChatActionContext().operateMessage,D=h.useHandleForwardMessage(),b=D.message,q=D.sendForwardMessage,k=D.conversationList,A=void 0===k?[]:k,T=a.useCallback((function(e){var s;y(((s={})[d.MESSAGE_OPERATE.FORWARD]=null,s))}),[y]),F=A.slice(0,2),M=A.slice(2),S=function(s){s.checked?m(e.__spreadArray(e.__spreadArray([],j,!0),[s.value],!1)):m(j.filter((function(e){return e!==s.value})))};return a.useEffect((function(){m([]),w([]),C("")}),[b]),b&&A.length>0&&s.jsx(n.Model,e.__assign({onClick:T},{children:s.jsxs("div",e.__assign({role:"button",tabIndex:0,className:"tui-forward",onClick:function(e){e.stopPropagation()}},{children:[s.jsxs("header",e.__assign({className:"tui-forward-header"},{children:[s.jsx(t.Icon,{type:r.IconTypes.CANCEL,width:16,height:16,onClick:T}),s.jsx("h2",e.__assign({className:"tui-forward-title"},{children:"Forward To"}))]})),s.jsx("div",e.__assign({className:"tui-forward-search"},{children:s.jsx(l.Input,{className:"tui-forward-search-input",placeholder:"Search",clearable:!0,value:N,onChange:function(e){var s,a;if(C(null===(s=e.target)||void 0===s?void 0:s.value),null===(a=e.target)||void 0===a?void 0:a.value){var i=A.filter((function(s){var a,i=u.getDisplayTitle(s).toLocaleLowerCase(),n=null===(a=e.target)||void 0===a?void 0:a.value.toLocaleLowerCase();return i.includes(n)}));w(i)}else w([])},prefix:s.jsx(t.Icon,{type:r.IconTypes.SEARCH,height:16,width:16})})})),s.jsxs("main",e.__assign({className:"tui-forward-main"},{children:[N&&s.jsxs("ul",e.__assign({className:"tui-forward-list"},{children:[s.jsx("h3",e.__assign({className:"tui-forward-list-title"},{children:"Search Result"})),p.length>0&&p.map((function(a){return s.jsxs("li",e.__assign({className:"tui-forward-list-item"},{children:[s.jsxs("label",e.__assign({htmlFor:"".concat(a.conversationID),className:"info"},{children:[s.jsx(c.Avatar,{image:u.getDisplayImage(a),size:40}),s.jsx("div",e.__assign({className:"info-nick"},{children:u.getDisplayTitle(a)}))]})),s.jsx(o.Checkbox,{onChange:S,id:"".concat(a.conversationID),value:a})]}),a.conversationID)})),0===p.length&&s.jsx("p",e.__assign({className:"no-result"},{children:"No Result"}))]})),!N&&F.length>0&&s.jsxs("ul",e.__assign({className:"tui-forward-list"},{children:[s.jsx("h3",e.__assign({className:"tui-forward-list-title"},{children:"Frequently Contacted"})),F.map((function(a){return s.jsxs("li",e.__assign({className:"tui-forward-list-item"},{children:[s.jsxs("label",e.__assign({htmlFor:"".concat(a.conversationID),className:"info"},{children:[s.jsx(c.Avatar,{image:u.getDisplayImage(a),size:40}),s.jsx("div",e.__assign({className:"info-nick"},{children:u.getDisplayTitle(a)}))]})),s.jsx(o.Checkbox,{onChange:S,id:"".concat(a.conversationID),value:a})]}),a.conversationID)}))]})),!N&&M.length>0&&s.jsxs("ul",e.__assign({className:"tui-forward-list"},{children:[s.jsx("h3",e.__assign({className:"tui-forward-list-title"},{children:"Recent Chats"})),M.map((function(a){return s.jsxs("li",e.__assign({className:"tui-forward-list-item"},{children:[s.jsxs("label",e.__assign({htmlFor:"".concat(a.conversationID),className:"info"},{children:[s.jsx(c.Avatar,{image:u.getDisplayImage(a),size:40}),s.jsx("div",e.__assign({className:"info-nick"},{children:u.getDisplayTitle(a)}))]})),s.jsx(o.Checkbox,{onChange:S,id:"".concat(a.conversationID),value:a})]}),a.conversationID)}))]}))]})),s.jsxs("footer",e.__assign({className:"tui-forward-footer"},{children:[s.jsx("div",e.__assign({className:"tui-forward-footer-name"},{children:j.length>0&&(_=j,(null==_?void 0:_.map((function(e){return u.getDisplayTitle(e)}))).toString())})),s.jsx("button",e.__assign({type:"button",className:"button",onClick:function(){var e;e=j,v?v({list:j,message:b}):q(j),T(e)},disabled:0===j.length},{children:"Forward"}))]}))]}))}))};
