"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("tslib"),t=require("react/jsx-runtime"),r=require("react"),s=require("../Input/Input.js"),n=require("../Icon/Icon.js"),a=require("../Icon/type.js"),i=require("./ConversationCreateSelectView.js"),c=require("../Avatar/Avatar.js"),o=require("../Avatar/default.js"),u=require("./hooks/useConversationCreate.js"),l=require("../../context/TUIKitContext.js");require("../../context/TUIMessageContext.js");var v=require("./ConversationCreate.js"),d=require("../../hooks/useConversation.js"),h=require("../Toast/index.js");exports.ConversationCreateUserSelectList=function(p){var x=this,_=p.isCreateGroup,C=p.selectList,j=p.setSelectList,f=p.className,g=p.conversationList,m=p.setIsCreateGroup,I=p.setConversationCreated,N=p.setPageState,q=r.useState(""),k=q[0],b=q[1],y=l.useTUIKitContext(),S=y.tim,A=y.setActiveConversation,T=r.useState({}),w=T[0],L=T[1],D=u.useConversationCreate(S,g,(function(e){L(e)})).getFriendListSortSearchResult,E=d.useConversation(S).createConversation,U=r.useRef(new Map);return t.jsxs(t.Fragment,{children:[t.jsx(s.Input,{className:"tui-conversation-create-search-input",placeholder:"Search",clearable:!0,value:k,onChange:function(t){return e.__awaiter(x,void 0,void 0,(function(){var r,s;return e.__generator(this,(function(e){switch(e.label){case 0:return r=t.target.value,b(r),s=L,[4,D(r)];case 1:return s.apply(void 0,[e.sent()]),[2]}}))}))},prefix:t.jsx(n.Icon,{type:a.IconTypes.SEARCH,height:16,width:16})}),_&&t.jsx(i.ConversationCreateSelectView,{selectList:C,setSelectList:j}),!_&&t.jsxs("div",e.__assign({role:"presentation",className:"tui-user",onClick:function(){m(!0),U.current.clear(),j([])}},{children:[t.jsx(n.Icon,{type:a.IconTypes.ADD}),t.jsx("div",e.__assign({className:"tui-user-name active"},{children:"New Group"}))]})),t.jsx("div",e.__assign({className:"tui-conversation-create ".concat(f)},{children:t.jsx("div",e.__assign({className:"tui-conversation-create-container"},{children:t.jsx("div",e.__assign({className:"tui-group-container"},{children:Object.keys(w).map((function(r){return 0!==w[r].length&&t.jsxs("div",e.__assign({className:"tui-group-box"},{children:[t.jsx("div",e.__assign({className:"title"},{children:r})),w[r].map((function(s,n){var a=s.userID,i=s.nick,u=s.avatar;return t.jsxs("label",e.__assign({role:"presentation",className:"tui-user tui-user-checkbox-label",htmlFor:"userChecked-".concat(r,"-").concat(a),onClick:function(t){!function(t){e.__awaiter(x,void 0,void 0,(function(){var r,s;return e.__generator(this,(function(e){switch(e.label){case 0:return _?[2]:(r=t.userID,[4,E("C2C".concat(r))]);case 1:return s=e.sent(),I(!1),A(s),[2]}}))}))}(s)}},{children:[t.jsx(c.Avatar,{size:30,image:u||o.defaultUserAvatar}),t.jsx("div",e.__assign({className:"tui-user-name"},{children:i||"".concat(a)})),_&&t.jsx("input",{onChange:function(t){!function(t,r,s){void 0===s&&(s=[]);var n=r.userID,a=t.target.checked;s.forEach((function(e){e.checked=a})),a?C.push({profile:r,domList:s}):C.splice(C.findIndex((function(e){return e.profile.userID===n})),1),j(e.__spreadArray([],C,!0))}(t,s,U.current.get(a))},type:"checkbox",ref:function(e){!function(e,t){if(t){U.current.has(e)||U.current.set(e,[]);var r=U.current.get(e);0!==r.length&&r.some((function(e){return e.id===t.id}))||r.push(t)}}(a,e)},id:"userChecked-".concat(r,"-").concat(a),className:"tui-user-checkbox"})]}),a)}))]}),r)}))}))}))})),_&&t.jsx("div",e.__assign({className:"tui-conversation-create-next-container"},{children:t.jsx("div",e.__assign({role:"presentation",className:"tui-conversation-create-next",onClick:function(){C&&0===C.length?h.Toast({text:"Participant cannot be empty.",type:"error"}):N(v.PageStateTypes.CREATE_DETAIL)}},{children:"Next"}))}))]})};
