import{__assign as o}from"tslib";import{jsx as t,jsxs as s}from"react/jsx-runtime";import e,{useState as r,useEffect as n}from"react";import i from"tim-js-sdk";import{MESSAGE_STATUS as l}from"../../constants.js";import{useTUIChatStateContext as m}from"../../context/TUIChatStateContext.js";import{useTUIMessageContext as a}from"../../context/TUIMessageContext.js";function u(e){var u=e.message,d=e.children,p=e.Progress,g=e.isShow,c=void 0!==g&&g,v=r(),f=v[0],S=v[1],h=r(0),x=h[0],P=h[1],M=m("MessageProgressWithContext").uploadPenddingMessageList,E=a("MessageProgressWithContext"),I=E.isShowProgress,j=void 0!==I&&I,C=E.Progress,T=p||C,y=c||j;return n((function(){M&&M.length>0&&M.map((function(o){return(null==o?void 0:o.ID)===(null==u?void 0:u.ID)&&(S(o),P(null==o?void 0:o.progress)),o}))}),[M]),y?T?t(T,{message:f}):!((null==u?void 0:u.type)!==i.TYPES.MSG_IMAGE&&(null==u?void 0:u.type)!==i.TYPES.MSG_VIDEO&&(null==u?void 0:u.type)!==i.TYPES.MSG_FILE||(null==u?void 0:u.status)!==l.UNSEND)&&s("div",o({className:"progress-box"},{children:[t("span",{className:"progress",style:{width:"".concat(100*x,"%")}}),d]})):null}var d=e.memo(u);function p(s){return t(d,o({},s))}export{p as MessageProgress};
