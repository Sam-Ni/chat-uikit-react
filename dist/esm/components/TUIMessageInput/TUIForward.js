import{__assign as e,__spreadArray as t}from"tslib";import{jsx as r,jsxs as a}from"react/jsx-runtime";import{useState as i,useCallback as o,useEffect as n}from"react";import{useTUIChatActionContext as l}from"../../context/TUIChatActionContext.js";import"../../context/TUIMessageContext.js";import{Model as s}from"../Model/index.js";import{Icon as c}from"../Icon/Icon.js";import{IconTypes as d}from"../Icon/type.js";import{Input as m}from"../Input/Input.js";import{Checkbox as u}from"../Checkbox/index.js";import{Avatar as h}from"../Avatar/Avatar.js";import{getDisplayImage as f,getDisplayTitle as v}from"../ConversationPreview/utils.js";import{MESSAGE_OPERATE as p}from"../../constants.js";import"./hooks/useHandleQuoteMessage.js";import{useHandleForwardMessage as g}from"./hooks/useHandleForwardMessage.js";function w(w){var N,C=w.handleForward,I=i([]),j=I[0],b=I[1],k=i([]),x=k[0],D=k[1],F=i(""),A=F[0],L=F[1],M=l().operateMessage,R=g(),y=R.message,S=R.sendForwardMessage,z=R.conversationList,H=void 0===z?[]:z,T=o((function(e){var t;M(((t={})[p.FORWARD]=null,t))}),[M]),E=H.slice(0,2),P=H.slice(2),U=function(e){e.checked?b(t(t([],j,!0),[e.value],!1)):b(j.filter((function(t){return t!==e.value})))};return n((function(){b([]),D([]),L("")}),[y]),y&&H.length>0&&r(s,e({onClick:T},{children:a("div",e({role:"button",tabIndex:0,className:"tui-forward",onClick:function(e){e.stopPropagation()}},{children:[a("header",e({className:"tui-forward-header"},{children:[r(c,{type:d.CANCEL,width:16,height:16,onClick:T}),r("h2",e({className:"tui-forward-title"},{children:"Forward To"}))]})),r("div",e({className:"tui-forward-search"},{children:r(m,{className:"tui-forward-search-input",placeholder:"Search",clearable:!0,value:A,onChange:function(e){var t,r;if(L(null===(t=e.target)||void 0===t?void 0:t.value),null===(r=e.target)||void 0===r?void 0:r.value){var a=H.filter((function(t){var r,a=v(t).toLocaleLowerCase(),i=null===(r=e.target)||void 0===r?void 0:r.value.toLocaleLowerCase();return a.includes(i)}));D(a)}else D([])},prefix:r(c,{type:d.SEARCH,height:16,width:16})})})),a("main",e({className:"tui-forward-main"},{children:[A&&a("ul",e({className:"tui-forward-list"},{children:[r("h3",e({className:"tui-forward-list-title"},{children:"Search Result"})),x.length>0&&x.map((function(t){return a("li",e({className:"tui-forward-list-item"},{children:[a("label",e({htmlFor:"".concat(t.conversationID),className:"info"},{children:[r(h,{image:f(t),size:40}),r("div",e({className:"info-nick"},{children:v(t)}))]})),r(u,{onChange:U,id:"".concat(t.conversationID),value:t})]}),t.conversationID)})),0===x.length&&r("p",e({className:"no-result"},{children:"No Result"}))]})),!A&&E.length>0&&a("ul",e({className:"tui-forward-list"},{children:[r("h3",e({className:"tui-forward-list-title"},{children:"Frequently Contacted"})),E.map((function(t){return a("li",e({className:"tui-forward-list-item"},{children:[a("label",e({htmlFor:"".concat(t.conversationID),className:"info"},{children:[r(h,{image:f(t),size:40}),r("div",e({className:"info-nick"},{children:v(t)}))]})),r(u,{onChange:U,id:"".concat(t.conversationID),value:t})]}),t.conversationID)}))]})),!A&&P.length>0&&a("ul",e({className:"tui-forward-list"},{children:[r("h3",e({className:"tui-forward-list-title"},{children:"Recent Chats"})),P.map((function(t){return a("li",e({className:"tui-forward-list-item"},{children:[a("label",e({htmlFor:"".concat(t.conversationID),className:"info"},{children:[r(h,{image:f(t),size:40}),r("div",e({className:"info-nick"},{children:v(t)}))]})),r(u,{onChange:U,id:"".concat(t.conversationID),value:t})]}),t.conversationID)}))]}))]})),a("footer",e({className:"tui-forward-footer"},{children:[r("div",e({className:"tui-forward-footer-name"},{children:j.length>0&&(N=j,(null==N?void 0:N.map((function(e){return v(e)}))).toString())})),r("button",e({type:"button",className:"button",onClick:function(){var e;e=j,C?C({list:j,message:y}):S(j),T(e)},disabled:0===j.length},{children:"Forward"}))]}))]}))}))}export{w as TUIForward};
