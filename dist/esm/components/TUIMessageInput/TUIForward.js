import{__assign as e,__spreadArray as t}from"tslib";import{jsxs as o,jsx as r}from"react/jsx-runtime";import{useState as i,useCallback as a,useEffect as n}from"react";import"../../context/TUIKitContext.js";import"../../context/TUIChatStateContext.js";import{useTUIChatActionContext as l}from"../../context/TUIChatActionContext.js";import"../../context/TUIMessageContext.js";import"../../context/ComponentContext.js";import"../../context/TUIMessageInputContext.js";import{Model as s}from"../Model/index.js";import{Icon as c}from"../Icon/Icon.js";import{IconTypes as d}from"../Icon/type.js";import{Input as m}from"../Input/Input.js";import{Checkbox as u}from"../Checkbox/index.js";import{Avatar as h}from"../Avatar/Avatar.js";import{getDisplayImage as f,getDisplayTitle as v}from"../ConversationPreview/utils.js";import{MESSAGE_OPERATE as p}from"../../constants.js";import"./hooks/useHandleQuoteMessage.js";import{useHandleForwardMessage as g}from"./hooks/useHandleForwardMessage.js";function w(w){var N=w.handleForward,C=i([]),I=C[0],x=C[1],j=i([]),b=j[0],k=j[1],F=i(""),D=F[0],T=F[1],M=l().operateMessage,A=g(),L=A.message,R=A.sendForwardMessage,U=A.conversationList,y=void 0===U?[]:U;console.log("TUIForward",L);var S,z=a((function(e){var t;M(((t={})[p.FORWARD]=null,t))}),[M]),H=y.slice(0,2),E=y.slice(2),P=function(e){e.checked?x(t(t([],I,!0),[e.value],!1)):x(I.filter((function(t){return t!==e.value})))};return n((function(){x([]),k([]),T("")}),[L]),L&&y.length>0&&o(s,e({onClick:z},{children:[o("div",e({role:"button",tabIndex:0,className:"tui-forward",onClick:function(e){e.stopPropagation()}},{children:[o("header",e({className:"tui-forward-header"},{children:[r(c,{type:d.CANCEL,width:16,height:16,onClick:z}),r("h2",e({className:"tui-forward-title"},{children:"Forward To"}))]})),r("div",e({className:"tui-forward-search"},{children:r(m,{className:"tui-forward-search-input",placeholder:"Search",clearable:!0,value:D,onChange:function(e){var t,o;if(T(null===(t=e.target)||void 0===t?void 0:t.value),null===(o=e.target)||void 0===o?void 0:o.value){var r=y.filter((function(t){var o,r=v(t).toLocaleLowerCase(),i=null===(o=e.target)||void 0===o?void 0:o.value.toLocaleLowerCase();return r.includes(i)}));k(r)}else k([])},prefix:r(c,{type:d.SEARCH,height:16,width:16})})})),o("main",e({className:"tui-forward-main"},{children:[D&&o("ul",e({className:"tui-forward-list"},{children:[r("h3",e({className:"tui-forward-list-title"},{children:"Search Result"})),b.length>0&&b.map((function(t){return o("li",e({className:"tui-forward-list-item"},{children:[o("label",e({htmlFor:"".concat(t.conversationID),className:"info"},{children:[r(h,{image:f(t),size:40}),r("div",e({className:"info-nick"},{children:v(t)}))]})),r(u,{onChange:P,id:"".concat(t.conversationID),value:t})]}),t.conversationID)})),0===b.length&&r("p",e({className:"no-result"},{children:"No Result"}))]})),!D&&H.length>0&&o("ul",e({className:"tui-forward-list"},{children:[r("h3",e({className:"tui-forward-list-title"},{children:"Frequently Contacted Test"})),H.map((function(t){return o("li",e({className:"tui-forward-list-item"},{children:[o("label",e({htmlFor:"".concat(t.conversationID),className:"info"},{children:[r(h,{image:f(t),size:40}),r("div",e({className:"info-nick"},{children:v(t)}))]})),r(u,{onChange:P,id:"".concat(t.conversationID),value:t})]}),t.conversationID)}))]})),!D&&E.length>0&&o("ul",e({className:"tui-forward-list"},{children:[r("h3",e({className:"tui-forward-list-title"},{children:"Recent Chats"})),E.map((function(t){return o("li",e({className:"tui-forward-list-item"},{children:[o("label",e({htmlFor:"".concat(t.conversationID),className:"info"},{children:[r(h,{image:f(t),size:40}),r("div",e({className:"info-nick"},{children:v(t)}))]})),r(u,{onChange:P,id:"".concat(t.conversationID),value:t})]}),t.conversationID)}))]}))]})),o("footer",e({className:"tui-forward-footer"},{children:[r("div",e({className:"tui-forward-footer-name"},{children:I.length>0&&(S=I,(null==S?void 0:S.map((function(e){return v(e)}))).toString())})),r("button",e({type:"button",className:"button",onClick:function(){var e;e=I,N?N({list:I,message:L}):R(I),z(e)},disabled:0===I.length},{children:"Forward"}))]}))]})),r("div",{children:"Test"})]}))}export{w as TUIForward};
