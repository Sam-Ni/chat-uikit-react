import{__assign as e}from"tslib";import{jsxs as n,jsx as o}from"react/jsx-runtime";import i,{useRef as t,useState as r}from"react";import{Avatar as a}from"../Avatar/Avatar.js";import{Icon as s}from"../Icon/Icon.js";import{IconTypes as c}from"../Icon/type.js";import{Plugins as l}from"../Plugins/index.js";import{useConversation as m}from"../../hooks/useConversation.js";import{useTUIKitContext as d}from"../../context/TUIKitContext.js";import"../../context/TUIMessageContext.js";function v(i){var v=i.conversation,p=i.Avatar,u=void 0===p?a:p,h=i.displayImage,f=i.displayTitle,C=i.displayMessage,N=i.displayTime,g=i.unread,P=i.active,x=i.setActiveConversation,I=t(null),j=P?"conversation-preview-content--active":"",w=g&&g>=1?"conversation-preview-content--unread":"",y=v.isPinned?"conversation-preview-content--pin":"",b=r(!1),M=b[0],k=b[1],A=d("ConversationPreviewContent"),T=A.tim,D=A.conversation,E=m(T),F=E.pinConversation,U=E.deleteConversation,z=function(e){var n=v.conversationID,o=v.isPinned;switch(e){case"pin":F({conversationID:n,isPinned:!o});break;case"delete":U(n),v===D&&x(null)}};return n("button",e({type:"button","aria-selected":P,role:"option",className:"conversation-preview-container ".concat(j," ").concat(w," ").concat(y),onClick:function(){x&&x(v),(null==I?void 0:I.current)&&I.current.blur()},onMouseEnter:function(){k(!0)},onMouseLeave:function(){k(!1)},ref:I},{children:[o("div",e({className:"avatar"},{children:o(u,{image:h,name:f,size:40})})),n("div",e({className:"content"},{children:[o("div",e({className:"title"},{children:f})),o("div",e({className:"message"},{children:C}))]})),n("div",e({className:"external"},{children:[o("div",g?e({className:"unread"},{children:g<=99?g:"99+"}):{className:"unread"}),o("div",M?e({className:"".concat(M?"more--hover":"more")},{children:o(l,{customClass:"more-handle-box",plugins:[o("div",e({role:"presentation",className:"more-handle-item",onClick:function(e){e.stopPropagation(),z("pin")}},{children:v.isPinned?"Cancel Pin":"Pin"})),o("div",e({className:"more-handle-item",style:{color:"#FF584C"},onClick:function(e){e.stopPropagation(),z("delete")},role:"presentation"},{children:"Delete"}))],showNumber:0,MoreIcon:o(s,{className:"icon-more",width:16,height:16,type:c.MORE})})}):e({className:"time"},{children:N}))]}))]}))}var p=i.memo(v);export{p as ConversationPreviewContent,v as unMemoConversationPreviewContent};
