import{__assign as o}from"tslib";import{jsx as t,jsxs as e,Fragment as n}from"react/jsx-runtime";import r,{useState as i,useRef as s}from"react";import{useTUIKitContext as a}from"../../context/TUIKitContext.js";import"../../context/TUIChatStateContext.js";import"../../context/TUIChatActionContext.js";import"../../context/TUIMessageContext.js";import"../../context/ComponentContext.js";import"../../context/TUIMessageInputContext.js";import v from"./hooks/useConversationList.js";import{ConversationPreview as c}from"../ConversationPreview/ConversationPreview.js";import"../ConversationPreview/ConversationPreviewContent.js";import{ConversationListContainer as m}from"../ConversationPreview/ConversationListContainer.js";import{Profile as C}from"../Profile/Profile.js";import{ConversationSearchInput as l}from"../ConversationSearch/ConversationSearchInput.js";import{ConversationSearchResult as u}from"../ConversationSearch/ConversationSearchResult.js";import{ConversationCreate as p}from"../ConversationCreate/ConversationCreate.js";import{Icon as f}from"../Icon/Icon.js";import{IconTypes as d}from"../Icon/type.js";import"../Input/Input.js";import"../ConversationCreate/ConversationGroupTypeInfo.js";import"tim-js-sdk";import{useTUIConversationContext as h}from"../../context/TUIConversationContext.js";import{getDisplayTitle as j}from"../ConversationPreview/utils.js";import{useConversationUpdate as I}from"./hooks/useConversationUpdate.js";function x(r){var x=r.Preview,w=r.Container,L=void 0===w?m:w,P=r.onConversationListUpdated,T=r.filterConversation,U=a("TUIConversationList"),g=U.tim,N=U.customClasses,S=U.conversation,y=U.setActiveConversation,A=U.setTUIProfileShow,k=h("TUIConversationList").filterConversation,E=T||k,R=i(0),b=R[0],F=R[1],M=v(g,(function(o,t){o.length&&y(S)}),E),D=M.conversationList,G=M.setConversationList;I(G,P,(function(){return F((function(o){return o+1}))}),E);var K=i(""),O=K[0],V=K[1],q=i(D),z=q[0],B=q[1],H=i(!1),J=H[0],Q=H[1],W=a().myProfile,X=s(null);return t("div",o({className:"tui-conversation ".concat(N||""),ref:X},{children:J?t(p,{conversationList:D,setConversationCreated:Q}):e(n,{children:[t(C,{profile:W,handleAvatar:function(){A(!0)}}),e("div",o({className:"tui-conversation-header"},{children:[t(l,{value:O,clearable:!0,onChange:function(o){var t,e;if(V(null===(t=o.target)||void 0===t?void 0:t.value),null===(e=o.target)||void 0===e?void 0:e.value){var n=D.filter((function(t){var e;return j(t).toLocaleLowerCase().includes(null===(e=o.target)||void 0===e?void 0:e.value.toLocaleLowerCase())}));B(n)}else B([])}}),t("div",o({className:"tui-conversation-create-icon"},{children:t(f,{onClick:function(){V(""),Q(!0)},type:d.CREATE,height:24,width:24})}))]})),t(L,o({setConversationList:G},{children:0===D.length?e("div",o({className:"no-result"},{children:[t(f,{className:"no-result-icon",type:d.EFFORT,width:42,height:42}),t("div",o({className:"no-result-message"},{children:"No conversation"}))]})):O?t(u,{Preview:x,searchValue:O,result:z}):D.map((function(e){return t(c,o({},{activeConversation:S,conversation:e,setActiveConversation:y,Preview:x,conversationUpdateCount:b}),e.conversationID)}))}))]})}))}var w=r.memo(x);export{w as TUIConversationList,x as UnMemoTUIConversationList};
