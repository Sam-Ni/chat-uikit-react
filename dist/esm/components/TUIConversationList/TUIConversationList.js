import{__assign as o}from"tslib";import{jsx as t,jsxs as e,Fragment as n}from"react/jsx-runtime";import r,{useState as i,useRef as s}from"react";import a from"tim-js-sdk";import{useTUIKitContext as v}from"../../context/TUIKitContext.js";import"../../context/TUIChatStateContext.js";import"../../context/TUIChatActionContext.js";import"../../context/TUIMessageContext.js";import"../../context/ComponentContext.js";import"../../context/TUIMessageInputContext.js";import c from"./hooks/useConversationList.js";import{ConversationPreview as C}from"../ConversationPreview/ConversationPreview.js";import"../ConversationPreview/ConversationPreviewContent.js";import"../ConversationPreview/MyConversationPreviewContent.js";import{ConversationListContainer as m}from"../ConversationPreview/ConversationListContainer.js";import{Profile as l}from"../Profile/Profile.js";import{ConversationSearchInput as u}from"../ConversationSearch/ConversationSearchInput.js";import{ConversationSearchResult as p}from"../ConversationSearch/ConversationSearchResult.js";import{ConversationCreate as f}from"../ConversationCreate/ConversationCreate.js";import{Icon as d}from"../Icon/Icon.js";import{IconTypes as h}from"../Icon/type.js";import"../Input/Input.js";import"../ConversationCreate/ConversationGroupTypeInfo.js";import{useTUIConversationContext as j}from"../../context/TUIConversationContext.js";import{getDisplayTitle as w}from"../ConversationPreview/utils.js";import{useConversationUpdate as I}from"./hooks/useConversationUpdate.js";function P(r){var P=r.Preview,x=r.Container,U=void 0===x?m:x,T=r.onConversationListUpdated,L=r.filterConversation,g=r.showSelf,y=void 0===g||g,S=r.showSearch,N=void 0===S||S,A=r.onlyGroupConversation,E=void 0!==A&&A,k=r.onlyC2CConversation,O=void 0!==k&&k,R=v("TUIConversationList"),D=R.tim,G=R.customClasses,M=R.conversation,V=R.setActiveConversation,b=R.setTUIProfileShow,F=j("TUIConversationList").filterConversation,Y=L||F,_=i(0),K=_[0],q=_[1],z=c(D,(function(o,t){o.length&&V(M)}),Y),B=z.conversationList,H=z.setConversationList;I(H,T,(function(){return q((function(o){return o+1}))}),Y);var J=i(""),Q=J[0],W=J[1],X=i(B),Z=X[0],$=X[1],oo=i(!1),to=oo[0],eo=oo[1],no=v().myProfile,ro=s(null);return t("div",o({className:"tui-conversation ".concat(G||""),ref:ro},{children:to?t(f,{conversationList:B,setConversationCreated:eo}):e(n,{children:[y&&t(l,{profile:no,handleAvatar:function(){b(!0)}}),N&&e("div",o({className:"tui-conversation-header"},{children:[t(u,{value:Q,clearable:!0,onChange:function(o){var t,e;if(W(null===(t=o.target)||void 0===t?void 0:t.value),null===(e=o.target)||void 0===e?void 0:e.value){var n=B.filter((function(t){var e;return w(t).toLocaleLowerCase().includes(null===(e=o.target)||void 0===e?void 0:e.value.toLocaleLowerCase())}));$(n)}else $([])}}),t("div",o({className:"tui-conversation-create-icon"},{children:t(d,{onClick:function(){W(""),eo(!0)},type:h.CREATE,height:24,width:24})}))]})),t(U,o({setConversationList:H},{children:0===B.length?e("div",o({className:"no-result"},{children:[t(d,{className:"no-result-icon",type:h.EFFORT,width:42,height:42}),t("div",o({className:"no-result-message"},{children:"No conversation"}))]})):Q?t(p,{Preview:P,searchValue:Q,result:Z}):E?B.filter((function(o){return o.type===a.TYPES.CONV_GROUP})).map((function(e){return t(C,o({},{activeConversation:M,conversation:e,setActiveConversation:V,Preview:P,conversationUpdateCount:K}),e.conversationID)})):O?B.filter((function(o){return o.type===a.TYPES.CONV_C2C})).map((function(e){return t(C,o({},{activeConversation:M,conversation:e,setActiveConversation:V,Preview:P,conversationUpdateCount:K}),e.conversationID)})):B.map((function(e){return t(C,o({},{activeConversation:M,conversation:e,setActiveConversation:V,Preview:P,conversationUpdateCount:K}),e.conversationID)}))}))]})}))}var x=r.memo(P);export{x as TUIConversationList,P as UnMemoTUIConversationList};
