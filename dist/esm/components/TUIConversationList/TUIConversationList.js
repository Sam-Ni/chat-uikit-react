import{__assign as o}from"tslib";import{jsx as e,jsxs as t,Fragment as r}from"react/jsx-runtime";import n,{useState as i,useRef as s}from"react";import{useTUIKitContext as a}from"../../context/TUIKitContext.js";import"../../context/TUIMessageContext.js";import v from"./hooks/useConversationList.js";import{ConversationPreview as c}from"../ConversationPreview/ConversationPreview.js";import{Icon as l}from"../Icon/Icon.js";import{IconTypes as m}from"../Icon/type.js";import"tim-js-sdk";import{useTUIConversationContext as C}from"../../context/TUIConversationContext.js";import{ConversationListContainer as u}from"../ConversationPreview/ConversationListContainer.js";import{Profile as f}from"../Profile/Profile.js";import{ConversationSearchInput as p}from"../ConversationSearch/ConversationSearchInput.js";import{ConversationSearchResult as d}from"../ConversationSearch/ConversationSearchResult.js";import{ConversationCreate as h}from"../ConversationCreate/ConversationCreate.js";import"../ConversationCreate/ConversationGroupTypeInfo.js";import{getDisplayTitle as j}from"../ConversationPreview/utils.js";import{useConversationUpdate as L}from"./hooks/useConversationUpdate.js";function w(n){var w=n.Preview,I=n.Container,P=void 0===I?u:I,g=n.onConversationListUpdated,T=n.filterConversation,U=a("TUIConversationList"),x=U.tim,N=U.customClasses,y=U.conversation,S=U.setActiveConversation,k=U.setTUIProfileShow,A=C("TUIConversationList").filterConversation,E=T||A,R=i(0),b=R[0],F=R[1],D=v(x,(function(o,e){o.length&&S(y)}),E),G=D.conversationList,K=D.setConversationList;L(K,g,(function(){return F((function(o){return o+1}))}),E);var M=i(""),O=M[0],V=M[1],q=i(G),z=q[0],B=q[1],H=i(!1),J=H[0],Q=H[1],W=a().myProfile,X=s(null);return e("div",o({className:"tui-conversation ".concat(N||""),ref:X},{children:J?e(h,{conversationList:G,setConversationCreated:Q}):t(r,{children:[e(f,{profile:W,handleAvatar:function(){k(!0)}}),t("div",o({className:"tui-conversation-header"},{children:[e(p,{value:O,clearable:!0,onChange:function(o){var e,t;if(V(null===(e=o.target)||void 0===e?void 0:e.value),null===(t=o.target)||void 0===t?void 0:t.value){var r=G.filter((function(e){var t;return j(e).toLocaleLowerCase().includes(null===(t=o.target)||void 0===t?void 0:t.value.toLocaleLowerCase())}));B(r)}else B([])}}),e("div",o({className:"tui-conversation-create-icon"},{children:e(l,{onClick:function(){V(""),Q(!0)},type:m.CREATE,height:24,width:24})}))]})),e(P,o({setConversationList:K},{children:0===G.length?t("div",o({className:"no-result"},{children:[e(l,{className:"no-result-icon",type:m.EFFORT,width:42,height:42}),e("div",o({className:"no-result-message"},{children:"No conversation"}))]})):O?e(d,{Preview:w,searchValue:O,result:z}):G.map((function(t){return e(c,o({},{activeConversation:y,conversation:t,setActiveConversation:S,Preview:w,conversationUpdateCount:b}),t.conversationID)}))}))]})}))}var I=n.memo(w);export{I as TUIConversationList,w as UnMemoTUIConversationList};
