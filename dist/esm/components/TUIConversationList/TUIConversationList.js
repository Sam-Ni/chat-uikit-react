import{__assign as o}from"tslib";import{jsx as t,jsxs as e,Fragment as n}from"react/jsx-runtime";import r,{useState as i,useRef as s}from"react";import a from"tim-js-sdk";import{useTUIKitContext as v}from"../../context/TUIKitContext.js";import"../../context/TUIChatStateContext.js";import"../../context/TUIChatActionContext.js";import"../../context/TUIMessageContext.js";import"../../context/ComponentContext.js";import"../../context/TUIMessageInputContext.js";import c from"./hooks/useConversationList.js";import{ConversationPreview as C}from"../ConversationPreview/ConversationPreview.js";import"../ConversationPreview/ConversationPreviewContent.js";import{ConversationListContainer as m}from"../ConversationPreview/ConversationListContainer.js";import{Profile as l}from"../Profile/Profile.js";import{ConversationSearchInput as u}from"../ConversationSearch/ConversationSearchInput.js";import{ConversationSearchResult as p}from"../ConversationSearch/ConversationSearchResult.js";import{ConversationCreate as f}from"../ConversationCreate/ConversationCreate.js";import{Icon as d}from"../Icon/Icon.js";import{IconTypes as h}from"../Icon/type.js";import"../Input/Input.js";import"../ConversationCreate/ConversationGroupTypeInfo.js";import{useTUIConversationContext as j}from"../../context/TUIConversationContext.js";import{getDisplayTitle as I}from"../ConversationPreview/utils.js";import{useConversationUpdate as P}from"./hooks/useConversationUpdate.js";function w(r){var w=r.Preview,x=r.Container,U=void 0===x?m:x,L=r.onConversationListUpdated,T=r.filterConversation,g=r.showSelf,S=void 0===g||g,y=r.showSearch,N=void 0===y||y,A=r.onlyGroupConversation,E=void 0!==A&&A,k=r.onlyC2CConversation,R=void 0!==k&&k,D=v("TUIConversationList"),G=D.tim,b=D.customClasses,F=D.conversation,M=D.setActiveConversation,O=D.setTUIProfileShow,V=j("TUIConversationList").filterConversation,Y=T||V,_=i(0),B=_[0],K=_[1],q=c(G,(function(o,t){o.length&&M(F)}),Y),z=q.conversationList,H=q.setConversationList;P(H,L,(function(){return K((function(o){return o+1}))}),Y);var J=i(""),Q=J[0],W=J[1],X=i(z),Z=X[0],$=X[1],oo=i(!1),to=oo[0],eo=oo[1],no=v().myProfile,ro=s(null);return t("div",o({className:"tui-conversation ".concat(b||""),ref:ro},{children:to?t(f,{conversationList:z,setConversationCreated:eo}):e(n,{children:[S&&t(l,{profile:no,handleAvatar:function(){O(!0)}}),N&&e("div",o({className:"tui-conversation-header"},{children:[t(u,{value:Q,clearable:!0,onChange:function(o){var t,e;if(W(null===(t=o.target)||void 0===t?void 0:t.value),null===(e=o.target)||void 0===e?void 0:e.value){var n=z.filter((function(t){var e;return I(t).toLocaleLowerCase().includes(null===(e=o.target)||void 0===e?void 0:e.value.toLocaleLowerCase())}));$(n)}else $([])}}),t("div",o({className:"tui-conversation-create-icon"},{children:t(d,{onClick:function(){W(""),eo(!0)},type:h.CREATE,height:24,width:24})}))]})),t(U,o({setConversationList:H},{children:0===z.length?e("div",o({className:"no-result"},{children:[t(d,{className:"no-result-icon",type:h.EFFORT,width:42,height:42}),t("div",o({className:"no-result-message"},{children:"No conversation"}))]})):Q?t(p,{Preview:w,searchValue:Q,result:Z}):E?z.filter((function(o){return o.type===a.TYPES.GRP_PUBLIC})).map((function(e){return t(C,o({},{activeConversation:F,conversation:e,setActiveConversation:M,Preview:w,conversationUpdateCount:B}),e.conversationID)})):R?z.filter((function(o){return o.type===a.TYPES.CONV_C2C})).map((function(e){return t(C,o({},{activeConversation:F,conversation:e,setActiveConversation:M,Preview:w,conversationUpdateCount:B}),e.conversationID)})):z.map((function(e){return t(C,o({},{activeConversation:F,conversation:e,setActiveConversation:M,Preview:w,conversationUpdateCount:B}),e.conversationID)}))}))]})}))}var x=r.memo(w);export{x as TUIConversationList,w as UnMemoTUIConversationList};
